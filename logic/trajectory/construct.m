% This script is automatically constructed by trajectory.m 

% No parachute... 
z_i(t) = piecewise((-1e-13<=t<10000), (18.5746/0.65034) * ((50)+18.5746) * (1-exp((-0.65034*(t--1e-13))/18.5746)) - (18.5746*(t--1e-13)) +2737125.91, (10000<=t<20000), (19.9116/0.74733) * ((-18.5746)+19.9116) * (1-exp((-0.74733*(t-10000))/19.9116)) - (19.9116*(t-10000)) +2553338.7184, (20000<=t<30000), (21.5953/0.87906) * ((-19.9116)+21.5953) * (1-exp((-0.87906*(t-20000))/21.5953)) - (21.5953*(t-20000)) +2354258.7346, (30000<=t<40000), (23.7758/1.0655) * ((-21.5953)+23.7758) * (1-exp((-1.0655*(t-30000))/23.7758)) - (23.7758*(t-30000)) +2138346.9498, (40000<=t<50000), (26.7494/1.3487) * ((-23.7758)+26.7494) * (1-exp((-1.3487*(t-40000))/26.7494)) - (26.7494*(t-40000)) +1900637.3742);
x_i(t) = (0*Q(L_min))/g(L_min) * (1-exp((-g(L_min)*t)/Q(L_min))) +-50;



for VAR = -1e-13:1000:50000
    y_i(t) = (50*Q(z_i(VAR)))/g(z_i(VAR)) * (1-exp((-g(z_i(VAR))*(t-VAR))/Q(z_i(VAR)))) +0;
    fplot(y_i,[0,6*10^4],'Color','yellow');
    plot(VAR,y_i(VAR),'d');
    hold on;
end
y_i(t) = (50*Q(z_i(t)))/g(z_i(t)) * (1-exp((-g(z_i(t))*(t-))/Q(z_i(t)))) +0;
fplot(y_i,[0,6*10^4],'Color','red');

dx_idt = diff(x_i);
dy_idt = diff(y_i);
dz_idt = diff(z_i);
