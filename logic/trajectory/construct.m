% This script is automatically constructed by trajectory.m 

% No parachute... 
x_i(t) = (0*Q(2737125.91))/g(2737125.91) * (1-exp((-g(2737125.91)*t)/Q(2737125.91))) +-50;
y_i(t) = (50*Q(2737125.91))/g(2737125.91) * (1-exp((-g(2737125.91)*t)/Q(2737125.91))) +0;
z_i(t) = piecewise((-1e-13<=t<10000), (18.5746/0.65034) * ((50)+18.5746) * (1-exp((-0.65034*(t--1e-13))/18.5746)) - (18.5746*(t--1e-13)) +2737125.91, (10000<=t<20000), (19.9116/0.74733) * ((-18.5746)+19.9116) * (1-exp((-0.74733*(t-10000))/19.9116)) - (19.9116*(t-10000)) +2553338.7184, (20000<=t<30000), (21.5953/0.87906) * ((-19.9116)+21.5953) * (1-exp((-0.87906*(t-20000))/21.5953)) - (21.5953*(t-20000)) +2354258.7346, (30000<=t<40000), (23.7758/1.0655) * ((-21.5953)+23.7758) * (1-exp((-1.0655*(t-30000))/23.7758)) - (23.7758*(t-30000)) +2138346.9498, (40000<=t<50000), (26.7494/1.3487) * ((-23.7758)+26.7494) * (1-exp((-1.3487*(t-40000))/26.7494)) - (26.7494*(t-40000)) +1900637.3742);

dx_idt = diff(x_i);
dy_idt = diff(y_i);
dz_idt = diff(z_i);

% Parachute... 
z_iParachute(t) = piecewise((30000.1<=t<40000.1), (5.4459/1.0655) * (((7296272172079980083*exp(-3748894846010496/836536593909651875))/3346146375638607500 - 6692292751277215/281474976710656)+5.4459) * (1-exp((-1.0655*(t-30000.1))/5.4459)) - (5.4459*(t-30000.1)) +82725081160646361483041200619347/38685626227668133590597632 - (3423872441144993*exp(-3748894846010496/836536593909651875))/70368744177664, (40000.1<=t<50000.1), (5.5884/1.1221) * ((-5.4459)+5.5884) * (1-exp((-1.1221*(t-40000.1))/5.5884)) - (5.5884*(t-40000.1)) +2083803.264, (50000.1<=t<60000.1), (5.7424/1.1848) * ((-5.5884)+5.7424) * (1-exp((-1.1848*(t-50000.1))/5.7424)) - (5.7424*(t-50000.1)) +2027919.626, (60000.1<=t<70000.1), (5.9098/1.2548) * ((-5.7424)+5.9098) * (1-exp((-1.2548*(t-60000.1))/5.9098)) - (5.9098*(t-60000.1)) +1970496.0123, (70000.1<=t<80000.1), (6.0925/1.3336) * ((-5.9098)+6.0925) * (1-exp((-1.3336*(t-70000.1))/6.0925)) - (6.0925*(t-70000.1)) +1911398.9967, (80000.1<=t<90000.1), (6.2931/1.4229) * ((-6.0925)+6.2931) * (1-exp((-1.4229*(t-80000.1))/6.2931)) - (6.2931*(t-80000.1)) +1850474.8299, (90000.1<=t<100000.1), (6.5146/1.5248) * ((-6.2931)+6.5146) * (1-exp((-1.5248*(t-90000.1))/6.5146)) - (6.5146*(t-90000.1)) +1787544.8494);
z_i(t) = piecewise((t<=t_o), z_i(t),(t>t_o), z_iParachute(t));

t_A_velX = dx_idt(t_o); t_A_posX = x_i(t_o); %Start pos, vel, and time
% If lies at discontinuous point!
if isnan(t_A_velX) == 1
    t_A_velX = (dx_idt(t_o+0.001)+dx_idt(t_o-0.001))/2;
end
x_iParachute(t) = (t_A_velX*Q_o(z_i(t_o)))/g(z_i(t_o)) * (1-exp((-g(z_i(t_o))*t)/Q_o(z_i(t_o)))) + t_A_posX;
x_i(t) = piecewise((t<=t_o), x_i(t), (t>t_o), x_iParachute(t));
t_A_velY = dy_idt(t_o); t_A_posY = y_i(t_o); %Start pos, vel, and time
% If lies at discontinuous point!
if isnan(t_A_velY) == 1
    t_A_velY = (dy_idt(t_o+0.001)+dy_idt(t_o-0.001))/2;
end
y_iParachute(t) = (t_A_velY*Q_o(z_i(t_o)))/g(z_i(t_o)) * (1-exp((-g(z_i(t_o))*t)/Q_o(z_i(t_o)))) + t_A_posY;
y_i(t) = piecewise((t<=t_o), y_i(t), (t>t_o), y_iParachute(t));

dx_idt = diff(x_i);
dy_idt = diff(y_i);
dz_idt = diff(z_i);
